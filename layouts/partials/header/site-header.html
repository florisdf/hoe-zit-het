{{ $featured_image := .Param "featured_image" | default "images/gohugo-default-sample-hero-image.jpg" }}
{{ if $featured_image }}
  {{/* Trimming the slash and adding absURL make sure the image works no matter where our site lives */}}
  {{ $featured_image := (trim $featured_image "/") | absURL }}

	{{/* If the image functions as a title, don't add a title */}}
	{{ if .Params.title_img }}
		{{ .Scratch.Set "header_img" (.Params.title_img | default $featured_image) }}
		{{ .Scratch.Set "header_overlay_class" "" }}
		{{ .Scratch.Set "title" "" }} 
		{{ .Scratch.Set "description" "" }} 
	{{ else }}
		{{ .Scratch.Set "header_img" "" }}
		{{ .Scratch.Set "header_overlay_class" "bg-black-60" }}
		{{ .Scratch.Set "title"  (.Title | default .Site.Title) }} 
		{{ .Scratch.Set "description" (.Params.description | default "") }} 
	{{ end }}
  <header>
		<div class="ph3 ph4-ns {{ .Scratch.Get "header_overlay_class" }}">
      {{ partial "header/site-navigation.html" .}}
      <div class="tc-l pv4 pv6-l contain bg-top" style="background-image: url('{{ .Scratch.Get "header_img" }}');">
        <h1 class="f2 f-subheadline-l fw2 white-90 mb0 lh-title">
          {{ .Scratch.Get "title" }}
        </h1>
        {{ with .Scratch.Get "description" }}
          <h2 class="fw1 f5 f3-l white-80 measure-wide-l center mt3">
            {{ . }}
          </h2>
        {{ end }}
      </div>
    </div>
  </header>
{{ else }}
  <header>
    <div class="ph3 ph4-ns pb3-m pb6-l {{ .Site.Params.background_color_class | default "bg-black" }}">
      {{ partial "header/site-navigation.html" . }}
      <div class="tc-l pv3">
        <h1 class="f2 f-subheadline-l fw2 light-silver mb0 lh-title">
          {{ .Title | default .Site.Title }}
        </h1>
        {{ with .Params.description }}
          <h2 class="fw1 f5 f3-l white-80 measure-wide-l center lh-copy mt3 mb4">
            {{ . }}
          </h2>
        {{ end }}
      </div>
    </div>
  </header>
{{ end }}
{{ partial "header/breadcrumbs.html" . }}
